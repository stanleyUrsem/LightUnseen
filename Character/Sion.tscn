[gd_scene load_steps=42 format=3 uid="uid://cy7fitk5e2igo"]

[ext_resource type="Script" path="res://Character/SionMovement.gd" id="1_6msgt"]
[ext_resource type="Shader" path="res://swap_color.gdshader" id="2_3op8r"]
[ext_resource type="Texture2D" uid="uid://br7u3fpkb7c2f" path="res://Character/Textures/SionTD/eyes.png" id="3_atfj3"]
[ext_resource type="Texture2D" uid="uid://c5jxxtp0an06n" path="res://Npc/npc_grad.png" id="3_hann1"]
[ext_resource type="Gradient" uid="uid://bvp80mb08dqts" path="res://Npc/diff_npc3.tres" id="4_m7jpf"]
[ext_resource type="Script" path="res://MouseToShader.gd" id="4_m734i"]
[ext_resource type="Texture2D" uid="uid://donk4eeujo6qo" path="res://Character/Textures/SionTD/sion.png" id="5_mwf2f"]
[ext_resource type="Script" path="res://Character/SionArtSetter.gd" id="5_rce5w"]
[ext_resource type="Shader" path="res://Character/eye_tracking.gdshader" id="6_3qogg"]
[ext_resource type="Gradient" uid="uid://cl6uxyhdwivk6" path="res://Npc/base_npc.tres" id="6_duucu"]
[ext_resource type="AnimationLibrary" uid="uid://c1k2kc7247equ" path="res://Character/Sion_2_anim_lib.tres" id="6_o8mu2"]
[ext_resource type="AnimationNodeBlendTree" uid="uid://cgvcqonlcymq2" path="res://Character/Textures/SionTD/topdownChar.tres" id="7_uuyot"]
[ext_resource type="Script" path="res://Abilities/Abilities.gd" id="8_q0dv7"]
[ext_resource type="Script" path="res://Hittable.gd" id="10_tav8q"]
[ext_resource type="Script" path="res://Character/StatsHolder.gd" id="13_ip521"]
[ext_resource type="Script" path="res://Character/Interact.gd" id="15_mg06p"]
[ext_resource type="Script" path="res://PassivesManager.gd" id="16_dvdfg"]
[ext_resource type="Texture2D" uid="uid://cgt4u6x0ednng" path="res://Envo/pickups.png" id="16_qym2e"]
[ext_resource type="Resource" uid="uid://dye5bo1dbh5fe" path="res://Character/Sion_stats.tres" id="16_rno2g"]
[ext_resource type="Script" path="res://Abilities/AbilityData.gd" id="17_5mfga"]
[ext_resource type="Script" path="res://Abilities/PassiveData.gd" id="17_r5jsg"]
[ext_resource type="PackedScene" uid="uid://d3own3do3t3k" path="res://Character/manaheal.tscn" id="18_4wnpx"]
[ext_resource type="Script" path="res://Character/Consume.gd" id="18_il7wj"]
[ext_resource type="Material" uid="uid://dlo3kh48c6xhw" path="res://Maps/Particles.tres" id="19_26564"]

[sub_resource type="Curve" id="Curve_lstxf"]
_data = [Vector2(0, 0), 0.0, 0.0, 0, 0, Vector2(0.5, 1), 0.0, 0.0, 0, 0, Vector2(1, 0), 0.0, 0.0, 0, 0]
point_count = 3

[sub_resource type="Curve" id="Curve_j4n5k"]
_data = [Vector2(0, 0), 0.0, 0.0, 0, 0, Vector2(0.503311, 1), 0.0, 0.0, 0, 0, Vector2(1, 0), 0.0, 0.0, 0, 0]
point_count = 3

[sub_resource type="GradientTexture1D" id="GradientTexture1D_sc26l"]
gradient = ExtResource("6_duucu")
width = 18

[sub_resource type="ShaderMaterial" id="ShaderMaterial_o21r3"]
shader = ExtResource("2_3op8r")
shader_parameter/alpha_override = 1.0
shader_parameter/num_colors = 18
shader_parameter/precision = 0.0
shader_parameter/index = null
shader_parameter/palette_in = ExtResource("3_hann1")
shader_parameter/palette_out = SubResource("GradientTexture1D_sc26l")

[sub_resource type="RectangleShape2D" id="RectangleShape2D_ygxu6"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_wabse"]
resource_local_to_scene = true
shader = ExtResource("6_3qogg")
shader_parameter/offset_multiplier = 4.0
shader_parameter/mouse_dir = Vector2(0, 0)
shader_parameter/tolerance = 0.23
shader_parameter/hsv_shift = Vector3(0, 0, 0)
shader_parameter/from_clr = Color(0, 1, 0, 1)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_irf28"]
size = Vector2(9, 20)

[sub_resource type="Curve" id="Curve_mb0qj"]
_data = [Vector2(0, 0), 0.0, 0.0, 0, 0, Vector2(0.511628, 1), 0.0, 0.0, 0, 0, Vector2(1, 0), 0.0, 0.0, 0, 0]
point_count = 3

[sub_resource type="Resource" id="Resource_60owp"]
script = ExtResource("17_r5jsg")
has_condition = true
delay = 2.0
damage_increase = 0.0
damage_increase_percentage = 0.0
health_increase = 0.0
health_increase_percentage = 0.0
mana_increase = 0.25
mana_increase_percentage = 1.0
defense_increase = 0.0
defense_increase_percentage = 0.0
displayName = "Mana Heal"
description = ""
form_type = 0

[sub_resource type="AtlasTexture" id="AtlasTexture_bjtvb"]
atlas = ExtResource("16_qym2e")
region = Rect2(32, 0, 32, 32)

[sub_resource type="Resource" id="Resource_cwwi8"]
script = ExtResource("17_5mfga")
keyBinds = Array[String](["Interact"])
abilityPath = ""
animName = ""
animNodeType = 0
oneShot = 0
value = 0.0
animOnly = false
damage = 0.0
mana = 0.0
speed = 0.0
useMouseAim = false
toggle = false
hold = false
dynamic_size = false
hold_index = 0
hotkey_index = 2
rotateToMouse = false
hasCooldown = false
zoom = 0.0
zoom_duration = 0.0
shake_force = 0.0
shake_duration = 0.0
displayName = "Interact"
description = ""
icon = SubResource("AtlasTexture_bjtvb")
form_type = 0

[sub_resource type="AtlasTexture" id="AtlasTexture_a7o75"]
atlas = ExtResource("16_qym2e")
region = Rect2(64, 0, 32, 32)

[sub_resource type="Resource" id="Resource_ugs33"]
script = ExtResource("17_5mfga")
keyBinds = Array[String](["Consume_1"])
abilityPath = ""
animName = ""
animNodeType = 0
oneShot = 0
value = 0.0
animOnly = false
damage = 30.0
mana = 4.0
speed = 0.0
useMouseAim = false
toggle = false
hold = false
dynamic_size = false
hold_index = 0
hotkey_index = 0
rotateToMouse = false
hasCooldown = true
zoom = 0.0
zoom_duration = 0.0
shake_force = 0.0
shake_duration = 0.0
displayName = "Consume_HP"
description = ""
icon = SubResource("AtlasTexture_a7o75")
form_type = 4

[sub_resource type="AtlasTexture" id="AtlasTexture_lk1xm"]
atlas = ExtResource("16_qym2e")
region = Rect2(32, 32, 32, 32)

[sub_resource type="Resource" id="Resource_nejrd"]
script = ExtResource("17_5mfga")
keyBinds = Array[String](["Consume_2"])
abilityPath = ""
animName = ""
animNodeType = 0
oneShot = 0
value = 0.0
animOnly = false
damage = 20.0
mana = 5.0
speed = 0.0
useMouseAim = false
toggle = false
hold = false
dynamic_size = false
hold_index = 0
hotkey_index = 1
rotateToMouse = false
hasCooldown = true
zoom = 0.0
zoom_duration = 0.0
shake_force = 0.0
shake_duration = 0.0
displayName = "Consume_MP"
description = ""
icon = SubResource("AtlasTexture_lk1xm")
icon_mat = ExtResource("19_26564")
form_type = 4

[sub_resource type="Gradient" id="Gradient_2fben"]
offsets = PackedFloat32Array(0, 0.0285987, 1)
colors = PackedColorArray(0.2484, 0.2484, 0.2484, 0.619608, 0.303233, 0.303233, 0.303233, 0.776471, 0, 0, 0, 0)

[sub_resource type="GradientTexture2D" id="GradientTexture2D_yij2q"]
gradient = SubResource("Gradient_2fben")
width = 256
height = 256
fill = 1
fill_from = Vector2(0.5, 0.5)
fill_to = Vector2(0.4, 0.1)
metadata/_snap_enabled = true

[node name="Sion" type="CharacterBody2D" node_paths=PackedStringArray("statsHolder")]
y_sort_enabled = true
collision_layer = 528
collision_mask = 65
motion_mode = 1
script = ExtResource("1_6msgt")
dodgeVelocity = 5.0
dodgeDuration = 1.0
statsHolder = NodePath("Stats")
rollCurve = SubResource("Curve_lstxf")
dodgeCurve = SubResource("Curve_j4n5k")
SPEED = 100.0

[node name="Art" type="Node2D" parent="." node_paths=PackedStringArray("body", "eyes")]
z_index = 2
material = SubResource("ShaderMaterial_o21r3")
script = ExtResource("5_rce5w")
body = NodePath(".")
eyes = NodePath("Eyes")
gradient_in = ExtResource("6_duucu")
gradient_out = ExtResource("4_m7jpf")
hsv_shift_out = Vector3(0.61, 0.01, -0.18)

[node name="ShapeCast2D" type="ShapeCast2D" parent="Art"]
position = Vector2(6, 6)
shape = SubResource("RectangleShape2D_ygxu6")
target_position = Vector2(0, 0)
collision_mask = 40
collide_with_areas = true

[node name="Eyes" type="Node2D" parent="Art" node_paths=PackedStringArray("user", "mat_nodes")]
material = SubResource("ShaderMaterial_wabse")
position = Vector2(0, 1)
script = ExtResource("4_m734i")
user = NodePath(".")
mat_nodes = [NodePath(".")]

[node name="Eyes" type="Sprite2D" parent="Art/Eyes"]
modulate = Color(1.2, 1.2, 1.2, 1)
z_index = 3
texture_filter = 1
use_parent_material = true
position = Vector2(-1, -2)
scale = Vector2(0.5, 0.7)
texture = ExtResource("3_atfj3")
hframes = 4
vframes = 3

[node name="Eyes2" type="Sprite2D" parent="Art/Eyes"]
modulate = Color(1.2, 1.2, 1.2, 1)
z_index = 3
texture_filter = 1
use_parent_material = true
position = Vector2(2, -2)
scale = Vector2(0.5, 0.7)
texture = ExtResource("3_atfj3")
hframes = 4
vframes = 3

[node name="Body" type="Sprite2D" parent="Art"]
z_index = 1
texture_filter = 1
use_parent_material = true
texture = ExtResource("5_mwf2f")
hframes = 5
vframes = 11

[node name="AnimationPlayer" type="AnimationPlayer" parent="."]
libraries = {
"": ExtResource("6_o8mu2")
}

[node name="AnimationTree" type="AnimationTree" parent="."]
libraries = {
"": ExtResource("6_o8mu2")
}
tree_root = ExtResource("7_uuyot")
anim_player = NodePath("../AnimationPlayer")
parameters/CrystalTransform/active = false
parameters/CrystalTransform/internal_active = false
parameters/CrystalTransform/request = 0
parameters/Death/blend_amount = 0.0
parameters/Harvest/active = false
parameters/Harvest/internal_active = false
parameters/Harvest/request = 0
parameters/IdleToWalk/blend_amount = 0.0
parameters/LeftOrRight/blend_amount = 1.0
parameters/Mine/active = false
parameters/Mine/internal_active = false
parameters/Mine/request = 0
parameters/OnDeath/active = false
parameters/OnDeath/internal_active = false
parameters/OnDeath/request = 0
parameters/Transform/active = false
parameters/Transform/internal_active = false
parameters/Transform/request = 0
parameters/Turn/add_amount = 1.0
parameters/UseAttack/active = false
parameters/UseAttack/internal_active = false
parameters/UseAttack/request = 0
parameters/UseDodge/active = false
parameters/UseDodge/internal_active = false
parameters/UseDodge/request = 0
parameters/UseLRAttack/active = false
parameters/UseLRAttack/internal_active = false
parameters/UseLRAttack/request = 0
parameters/UseRoll/active = false
parameters/UseRoll/internal_active = false
parameters/UseRoll/request = 0

[node name="Hittable" type="CollisionShape2D" parent="."]
visible = false
z_index = 3
position = Vector2(0, 5)
shape = SubResource("RectangleShape2D_irf28")
script = ExtResource("10_tav8q")
type = 1

[node name="Abilities" type="Node2D" parent="." node_paths=PackedStringArray("charMovement", "abilitySpawns", "left", "right", "statsHolder", "interaction")]
script = ExtResource("8_q0dv7")
charMovement = NodePath("..")
abilitySpawns = [NodePath("../AbilitySpawns/LeftArm"), NodePath("../AbilitySpawns/RightArm")]
left = NodePath("../AbilitySpawns/LeftArm")
right = NodePath("../AbilitySpawns/RightArm")
timer_duration = 2.0
movement_duration = 0.5
dist_multiplier = 2.0
move_curve = SubResource("Curve_mb0qj")
statsHolder = NodePath("../Stats")
interaction = NodePath("../Interaction")

[node name="AbilitySpawns" type="Node2D" parent="."]

[node name="LeftArm" type="Marker2D" parent="AbilitySpawns"]
position = Vector2(-4, 12)

[node name="Polygon2D" type="Polygon2D" parent="AbilitySpawns/LeftArm"]
visible = false
z_index = 99
color = Color(1, 0, 0, 1)
polygon = PackedVector2Array(-1, -1, 1, -1, 1, 1, -1, 1)

[node name="RightArm" type="Marker2D" parent="AbilitySpawns"]
position = Vector2(3, 12)

[node name="Polygon2D" type="Polygon2D" parent="AbilitySpawns/RightArm"]
visible = false
z_index = 99
color = Color(0, 0, 1, 1)
polygon = PackedVector2Array(-1, -1, 1, -1, 1, 1, -1, 1)

[node name="Stats" type="Node2D" parent="." node_paths=PackedStringArray("charMovement", "abilities", "passives", "hittable")]
script = ExtResource("13_ip521")
stats_resource = ExtResource("16_rno2g")
charMovement = NodePath("..")
abilities = NodePath("../Abilities")
passives = NodePath("../Passives")
hittable = NodePath("../Hittable")
hitPerSec = -5.0
old_hp = -1.0
old_mana = -1.0

[node name="Passives" type="Node2D" parent="." node_paths=PackedStringArray("statsHolder", "movement", "mana_heal_fx")]
script = ExtResource("16_dvdfg")
statsHolder = NodePath("../Stats")
movement = NodePath("..")
mana_heal_fx = NodePath("../ManaHealFX")
passive_data = Array[ExtResource("17_r5jsg")]([SubResource("Resource_60owp")])

[node name="ManaHealFX" parent="." instance=ExtResource("18_4wnpx")]
position = Vector2(0, 16)

[node name="Interaction" type="Node2D" parent="." node_paths=PackedStringArray("cast", "animTree", "movement")]
script = ExtResource("15_mg06p")
cast = NodePath("../Art/ShapeCast2D")
secondsPerResource = 0.75
animTree = NodePath("../AnimationTree")
movement = NodePath("..")
data = SubResource("Resource_cwwi8")
interaction_allowed = true

[node name="Consume" type="Node2D" parent="." node_paths=PackedStringArray("stats_holder")]
script = ExtResource("18_il7wj")
stats_holder = NodePath("../Stats")
hp_data = SubResource("Resource_ugs33")
mana_data = SubResource("Resource_nejrd")

[node name="AudioStreamPlayer" type="AudioStreamPlayer" parent="."]
volume_db = 5.0
bus = &"SFX"

[node name="AudioListener2D" type="AudioListener2D" parent="."]
current = true

[node name="PointLight2D" type="PointLight2D" parent="."]
energy = 12.0
range_item_cull_mask = 2
texture = SubResource("GradientTexture2D_yij2q")
